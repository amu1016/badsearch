<%= render "shared/header" %>

<div class="search-form-wrap">
  <div class="search-form-header">
    サークル検索
  </div>
  <div class="search-place-title">
    都道府県選択
  </div>
  <div class="search-place">
    <%= search_form_for @q, url: search_clubs_path, class: 'prefecture-city' do |f| %>
      <div class="search-form">
        <div class="search-prefecture">
          <%= f.select :prefecture_id, nil, {class:"search-box-top" },{'v-model': 'selectedPref', '@change': 'getCities(selectedPref)'} do %>
            <option v-for="prefecture in prefectures" :key="prefecture.name" :value="prefecture.id">
              {{prefecture.name}}
            </option>
          <% end %>
          <%= f.select :city_id, class:"search-box-top" do %>
          <option v-for="city in cities" :key="city.name" :value="city.id">{{city.name}}</option>
          <% end %>
        </div>
        <%= f.submit "検索" ,class:"search-btn" %>
        <div class="city-accordion-label">
          <i class="fas fa-sliders-h"></i>
          <span>市区町村で絞り込む </span>
          <i class="fas fa-angle-down city-down"></i>
        </div>
      </div>
    <% end %>
    <div class="city-accordion">
      <div class="city-accordion-body">
        選択された都道府県に対応する市区町村一覧をチェックボックス形式で表示する
      <div>
    </div>
    <%= javascript_pack_tag 'hello_vue' %>
    <%= stylesheet_pack_tag 'hello_vue' %>
  </div>
</div>

  <div class="search-accordion-label">
    <div class="search-accordion-label-left">
      <%= "検索結果：#{@clubs.count} 件"%>
    </div>
    <div class="search-accordion-label-right">
      <i class="fas fa-sliders-h"></i>
      <span>絞り込み </span>
      <i class="fas fa-angle-down search-down"></i>
    </div>
  </div>
  <div class="search-accordion">
    <div class="search-accordion-body">
    ここに検索条件を追加していく
    </div>
  </div>



<div class='club-contents'>
    <h2 class='club-content-title'>新規サークル一覧</h2>
    <ul class='club-lists'>
      <% @clubs.each do |club| %>
        <li class='list'>
          <%= link_to club_path(club.id), class: "link" do %>
          <div class="club-content-wrap">
            <div class="club-top">
              <div class='club-info'>
                <div class="created-date">
                <%= club.created_at.to_s(:datetime_jp)%>
                </div>
                <h3 class="club-name">
                <%= club.name%>
                </h3>
                <div class="club-place">
                  <div class="club-prefecture">
                  <%= club.prefecture.name%>
                  </div>
                  <div class="club-city">
                  <%= club.city.name%>
                  </div>
                </div>
              </div>
              <div class="club-image-content">
                <%= image_tag club.images[0], class: "club-image" if club.images.attached? %>
              </div>
            </div>
            <div class="club-bottom">
              <div class="club-comment">
                <%= club.information %>
              </div>
              <% if user_signed_in? %>
                <% if current_user.own?(club) %>
                  <%= link_to edit_club_path(club), class: "link" do %>
                    <div class='favorite-btn'>
                      <i class="far fa-edit"></i>
                    </div>
                  <% end%>
                <% else %>
                  <div id="like-button-<%= club.id %>">
                  <% if current_user&.like?(club) %>
                    <%= render partial: 'likes/unlike_button', locals: {club: club}%>
                  <% else %>
                    <%= render partial: 'likes/like_button', locals: {club: club}%>
                  <% end%>
                  </div>
                <% end %>
              <% end %> 
            </div>
          </div>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
</div>